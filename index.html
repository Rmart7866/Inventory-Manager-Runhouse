<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Run House Inventory Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            margin-bottom: 30px;
        }

        h1 {
            font-size: 36px;
            font-weight: 800;
            color: #1a1a1a;
            margin-bottom: 12px;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            color: #6c757d;
            font-size: 16px;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .upload-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .upload-zone {
            border: 3px dashed #cbd5e0;
            border-radius: 16px;
            padding: 40px 20px;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .upload-zone:hover {
            border-color: #667eea;
            background: #f0f2ff;
            transform: translateY(-2px);
        }

        .upload-zone.dragover {
            border-color: #28a745;
            background: #e8f5e9;
            transform: scale(1.02);
        }

        .upload-zone h3 {
            font-size: 20px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .upload-zone p {
            color: #6c757d;
            font-size: 14px;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 12px;
            opacity: 0.5;
        }

        .file-uploaded {
            display: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 20px;
            color: white;
            align-items: center;
            justify-content: space-between;
        }

        .file-uploaded.active {
            display: flex;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .file-info strong {
            font-size: 16px;
            font-weight: 600;
        }

        .clear-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 10px 20px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .clear-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .report-section {
            display: none;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.8;
            max-height: 600px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .report-section.active {
            display: block;
        }

        .download-section {
            display: none;
            margin-top: 30px;
        }

        .download-section.active {
            display: block;
        }

        .download-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .download-header h2 {
            font-size: 24px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .download-header p {
            color: #6c757d;
            font-size: 14px;
        }

        .download-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .download-card {
            background: #f8f9fa;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
        }

        .download-card h3 {
            font-size: 18px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .download-card p {
            color: #6c757d;
            font-size: 13px;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .download-btn {
            background: linear-gradient(135deg, #28a745 0%, #34ce57 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 24px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            width: 100%;
        }

        .download-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.35);
        }

        .download-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .download-btn.secondary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .download-btn.secondary:hover:not(:disabled) {
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.35);
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 16px 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .info-box h4 {
            font-size: 14px;
            font-weight: 700;
            color: #1565C0;
            margin-bottom: 8px;
        }

        .info-box ul {
            list-style: none;
            padding-left: 0;
        }

        .info-box li {
            color: #1976D2;
            font-size: 13px;
            margin-bottom: 4px;
            padding-left: 20px;
            position: relative;
        }

        .info-box li:before {
            content: "‚Ä¢";
            position: absolute;
            left: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>üèÉ Run House Inventory Tracker</h1>
            <p class="subtitle">
                Compare yesterday's inventory with today's inventory<br>
                <strong>Discontinued colorways</strong> will be set to quantity 0<br>
                <strong>New colorways</strong> will be identified automatically
            </p>

            <div class="upload-grid">
                <!-- Yesterday's CSV -->
                <div>
                    <div class="upload-zone" id="yesterday-dropzone">
                        <div class="upload-icon">üìÅ</div>
                        <h3>Yesterday's CSV</h3>
                        <p>Drop your old inventory file here</p>
                        <input type="file" style="display: none;" id="yesterday-file" accept=".csv">
                    </div>
                    <div class="file-uploaded" id="yesterday-uploaded">
                        <div class="file-info">
                            <span>‚úì</span>
                            <strong id="yesterday-filename"></strong>
                        </div>
                        <button class="clear-btn" onclick="clearYesterday()">Clear</button>
                    </div>
                </div>
                
                <!-- Today's CSV -->
                <div>
                    <div class="upload-zone" id="today-dropzone">
                        <div class="upload-icon">üìÅ</div>
                        <h3>Today's CSV</h3>
                        <p>Drop your new inventory file here</p>
                        <input type="file" style="display: none;" id="today-file" accept=".csv">
                    </div>
                    <div class="file-uploaded" id="today-uploaded">
                        <div class="file-info">
                            <span>‚úì</span>
                            <strong id="today-filename"></strong>
                        </div>
                        <button class="clear-btn" onclick="clearToday()">Clear</button>
                    </div>
                </div>
            </div>

            <!-- Comparison Report -->
            <div class="report-section" id="comparison-report"></div>

            <!-- Download Section -->
            <div class="download-section" id="download-section">
                <div class="download-header">
                    <h2>üì• Download CSV Files</h2>
                    <p>Two separate files for easy Shopify uploading</p>
                </div>

                <div class="download-grid">
                    <div class="download-card">
                        <h3>üö´ Discontinued Colorways</h3>
                        <p>All colorways from yesterday that are NOT in today's inventory. Quantities set to 0.</p>
                        <button class="download-btn" id="download-discontinued-btn" onclick="downloadDiscontinued()" disabled>
                            Download Discontinued
                        </button>
                    </div>

                    <div class="download-card">
                        <h3>‚ú® New Colorways</h3>
                        <p>All colorways in today's inventory that were NOT in yesterday's inventory.</p>
                        <button class="download-btn secondary" id="download-new-btn" onclick="downloadNew()" disabled>
                            Download New Colorways
                        </button>
                    </div>
                </div>

                <div class="info-box">
                    <h4>üìã How to use these files:</h4>
                    <ul>
                        <li><strong>Discontinued CSV:</strong> Upload to Shopify to set discontinued products to 0 quantity</li>
                        <li><strong>New Colorways CSV:</strong> Upload to Shopify to add new products with current quantities</li>
                        <li>Both files are ready to import directly into Shopify</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let yesterdayData = null;
        let todayData = null;
        let comparisonResult = null;

        // Setup event listeners
        document.addEventListener('DOMContentLoaded', function() {
            setupDropZone('yesterday');
            setupDropZone('today');
        });

        function setupDropZone(type) {
            const dropzone = document.getElementById(`${type}-dropzone`);
            const fileInput = document.getElementById(`${type}-file`);

            dropzone.addEventListener('click', () => fileInput.click());
            
            dropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropzone.classList.add('dragover');
            });
            
            dropzone.addEventListener('dragleave', () => {
                dropzone.classList.remove('dragover');
            });
            
            dropzone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropzone.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file && file.name.endsWith('.csv')) {
                    handleFile(file, type);
                }
            });
            
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    handleFile(file, type);
                }
            });
        }

        function handleFile(file, type) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const csvText = e.target.result;
                
                if (type === 'yesterday') {
                    yesterdayData = csvText;
                    document.getElementById('yesterday-dropzone').style.display = 'none';
                    document.getElementById('yesterday-uploaded').classList.add('active');
                    document.getElementById('yesterday-filename').textContent = file.name;
                } else {
                    todayData = csvText;
                    document.getElementById('today-dropzone').style.display = 'none';
                    document.getElementById('today-uploaded').classList.add('active');
                    document.getElementById('today-filename').textContent = file.name;
                }
                
                // If both files are loaded, run comparison
                if (yesterdayData && todayData) {
                    runComparison();
                }
            };
            reader.readAsText(file);
        }

        function clearYesterday() {
            yesterdayData = null;
            document.getElementById('yesterday-dropzone').style.display = 'block';
            document.getElementById('yesterday-uploaded').classList.remove('active');
            document.getElementById('yesterday-file').value = '';
            hideResults();
        }

        function clearToday() {
            todayData = null;
            document.getElementById('today-dropzone').style.display = 'block';
            document.getElementById('today-uploaded').classList.remove('active');
            document.getElementById('today-file').value = '';
            hideResults();
        }

        function hideResults() {
            document.getElementById('comparison-report').classList.remove('active');
            document.getElementById('download-section').classList.remove('active');
            comparisonResult = null;
        }

        function runComparison() {
            try {
                comparisonResult = compareInventories(yesterdayData, todayData);
                const report = generateReport(comparisonResult);
                
                // Show report
                document.getElementById('comparison-report').textContent = report;
                document.getElementById('comparison-report').classList.add('active');
                
                // Show download section
                document.getElementById('download-section').classList.add('active');
                
                // Enable/disable download buttons
                const hasDiscontinued = comparisonResult.discontinuedColorways.length > 0;
                const hasNew = comparisonResult.newColorways.length > 0;
                
                document.getElementById('download-discontinued-btn').disabled = !hasDiscontinued;
                document.getElementById('download-new-btn').disabled = !hasNew;
                
            } catch (error) {
                alert('Error comparing files: ' + error.message);
                console.error(error);
            }
        }

        function downloadDiscontinued() {
            if (!comparisonResult || comparisonResult.discontinuedColorways.length === 0) {
                alert('No discontinued colorways to download');
                return;
            }
            
            const csv = generateDiscontinuedCSV(comparisonResult.discontinuedColorways);
            downloadCSV(csv, 'discontinued-colorways.csv');
        }

        function downloadNew() {
            if (!comparisonResult || comparisonResult.newColorways.length === 0) {
                alert('No new colorways to download');
                return;
            }
            
            const csv = generateNewColorwaysCSV(comparisonResult.newColorways);
            downloadCSV(csv, 'new-colorways.csv');
        }

        function downloadCSV(csvContent, filename) {
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
    <script src="inventory-tracker-FINAL.js"></script>
</body>
</html>
// ====================================================================
// INVENTORY TRACKER - CORRECTED VERSION
// ====================================================================
// Discontinued = Any colorway not present in new file (set qty to 0)
// New Colorway = Any colorway in new file that wasn't in old file
// ====================================================================

function compareInventories(yesterdayCSV, todayCSV) {
    console.log('Starting comparison...');
    
    // Parse CSVs
    const yesterday = parseShopifyCSV(yesterdayCSV);
    const today = parseShopifyCSV(todayCSV);
    
    console.log(`Yesterday variants: ${yesterday.length}`);
    console.log(`Today variants: ${today.length}`);
    
    // Group by colorway (Handle)
    const yesterdayColorways = new Map(); // handle -> variants
    const todayColorways = new Map();
    
    // Group yesterday's data by Handle (colorway)
    yesterday.forEach(variant => {
        if (!yesterdayColorways.has(variant.Handle)) {
            yesterdayColorways.set(variant.Handle, []);
        }
        yesterdayColorways.get(variant.Handle).push(variant);
    });
    
    // Group today's data by Handle (colorway)
    today.forEach(variant => {
        if (!todayColorways.has(variant.Handle)) {
            todayColorways.set(variant.Handle, []);
        }
        todayColorways.get(variant.Handle).push(variant);
    });
    
    // Find DISCONTINUED colorways (in yesterday but NOT in today)
    const discontinuedColorways = [];
    
    yesterdayColorways.forEach((variants, handle) => {
        if (!todayColorways.has(handle)) {
            // This colorway is discontinued
            discontinuedColorways.push({
                handle: handle,
                title: variants[0].Title,
                variants: variants
            });
        }
    });
    
    // Find NEW colorways (in today but NOT in yesterday)
    const newColorways = [];
    
    todayColorways.forEach((variants, handle) => {
        if (!yesterdayColorways.has(handle)) {
            // This is a new colorway
            newColorways.push({
                handle: handle,
                title: variants[0].Title,
                variants: variants
            });
        }
    });
    
    // Sort alphabetically by title
    discontinuedColorways.sort((a, b) => a.title.localeCompare(b.title));
    newColorways.sort((a, b) => a.title.localeCompare(b.title));
    
    console.log(`Found ${discontinuedColorways.length} discontinued colorways`);
    console.log(`Found ${newColorways.length} new colorways`);
    
    return {
        discontinuedColorways,
        newColorways,
        yesterdayColorways,
        todayColorways
    };
}

function parseShopifyCSV(csvText) {
    const lines = csvText.trim().split('\n');
    const headers = lines[0].split(',').map(h => h.trim().replace(/^"|"$/g, ''));
    
    const handleIndex = headers.indexOf('Handle');
    const titleIndex = headers.indexOf('Title');
    const variantSKUIndex = headers.indexOf('Variant SKU');
    const option1Index = headers.indexOf('Option1 Value'); // Size
    const variantInventoryQtyIndex = headers.indexOf('Variant Inventory Qty');
    
    const variants = [];
    
    for (let i = 1; i < lines.length; i++) {
        const line = lines[i];
        if (!line.trim()) continue;
        
        const values = parseCSVLine(line);
        
        const handle = values[handleIndex]?.trim().replace(/^"|"$/g, '') || '';
        const title = values[titleIndex]?.trim().replace(/^"|"$/g, '') || '';
        const sku = values[variantSKUIndex]?.trim().replace(/^"|"$/g, '') || '';
        const size = values[option1Index]?.trim().replace(/^"|"$/g, '') || '';
        const qty = values[variantInventoryQtyIndex]?.trim().replace(/^"|"$/g, '') || '0';
        
        if (handle && size) {
            variants.push({
                Handle: handle,
                Title: title,
                SKU: sku,
                Size: size,
                Quantity: parseInt(qty) || 0
            });
        }
    }
    
    return variants;
}

function parseCSVLine(line) {
    const values = [];
    let current = '';
    let inQuotes = false;
    
    for (let i = 0; i < line.length; i++) {
        const char = line[i];
        
        if (char === '"') {
            if (inQuotes && line[i + 1] === '"') {
                current += '"';
                i++;
            } else {
                inQuotes = !inQuotes;
            }
        } else if (char === ',' && !inQuotes) {
            values.push(current);
            current = '';
        } else {
            current += char;
        }
    }
    values.push(current);
    
    return values;
}

function generateReport(comparison) {
    const { discontinuedColorways, newColorways } = comparison;
    
    let report = '';
    
    // Header
    report += '======================================================================\n';
    report += '              RUN HOUSE INVENTORY COMPARISON REPORT\n';
    report += '======================================================================\n\n';
    
    // Discontinued Colorways Section
    report += `DISCONTINUED COLORWAYS\n`;
    report += `======================================================================\n`;
    report += `${discontinuedColorways.length} colorways discontinued\n`;
    report += `${discontinuedColorways.reduce((sum, cw) => sum + cw.variants.length, 0)} total variants\n\n`;
    
    if (discontinuedColorways.length > 0) {
        discontinuedColorways.forEach(colorway => {
            report += `${colorway.title}\n`;
            report += `  Sizes: `;
            const sizeList = colorway.variants
                .sort((a, b) => parseFloat(a.Size) - parseFloat(b.Size))
                .map(v => `${v.Size} (${v.Quantity})`)
                .join(', ');
            report += sizeList + '\n';
            report += `  Total variants: ${colorway.variants.length}\n\n`;
        });
    } else {
        report += 'No discontinued colorways found.\n\n';
    }
    
    report += '\n';
    
    // New Colorways Section
    report += `NEW COLORWAYS\n`;
    report += `======================================================================\n`;
    report += `${newColorways.length} new colorways detected\n`;
    report += `${newColorways.reduce((sum, cw) => sum + cw.variants.length, 0)} total variants\n\n`;
    
    if (newColorways.length > 0) {
        newColorways.forEach(colorway => {
            report += `${colorway.title}\n`;
            report += `  Sizes: `;
            const sizeList = colorway.variants
                .sort((a, b) => parseFloat(a.Size) - parseFloat(b.Size))
                .map(v => `${v.Size} (${v.Quantity})`)
                .join(', ');
            report += sizeList + '\n';
            report += `  Total variants: ${colorway.variants.length}\n\n`;
        });
    } else {
        report += 'No new colorways found.\n\n';
    }
    
    report += '======================================================================\n';
    
    return report;
}

function generateDiscontinuedCSV(discontinuedColorways) {
    if (discontinuedColorways.length === 0) {
        return null;
    }
    
    // Shopify CSV format
    let csv = 'Handle,Title,Body (HTML),Vendor,Product Category,Type,Tags,Published,Option1 Name,Option1 Value,Variant SKU,Variant Grams,Variant Inventory Tracker,Variant Inventory Qty,Variant Inventory Policy,Variant Fulfillment Service,Variant Price,Variant Compare At Price,Variant Requires Shipping,Variant Taxable,Variant Barcode,Image Src,Image Position,Image Alt Text,Gift Card,SEO Title,SEO Description,Google Shopping / Google Product Category,Google Shopping / Gender,Google Shopping / Age Group,Google Shopping / MPN,Google Shopping / Condition,Google Shopping / Custom Product,Google Shopping / Custom Label 0,Google Shopping / Custom Label 1,Google Shopping / Custom Label 2,Google Shopping / Custom Label 3,Google Shopping / Custom Label 4,Variant Image,Variant Weight Unit,Variant Tax Code,Cost per item,Included / United States,Price / United States,Compare At Price / United States,Included / International,Price / International,Compare At Price / International,Status\n';
    
    discontinuedColorways.forEach(colorway => {
        colorway.variants.forEach((variant, index) => {
            const isFirstVariant = index === 0;
            
            csv += `"${variant.Handle}",`;
            csv += `"${isFirstVariant ? variant.Title : ''}",`;
            csv += `"",`; // Body (HTML)
            csv += `"",`; // Vendor
            csv += `"",`; // Product Category
            csv += `"",`; // Type
            csv += `"",`; // Tags
            csv += `"TRUE",`; // Published
            csv += `"${isFirstVariant ? 'Size' : ''}",`; // Option1 Name
            csv += `"${variant.Size}",`; // Option1 Value
            csv += `"${variant.SKU}",`; // Variant SKU
            csv += `"0",`; // Variant Grams
            csv += `"shopify",`; // Variant Inventory Tracker
            csv += `"0",`; // Variant Inventory Qty - SET TO 0
            csv += `"deny",`; // Variant Inventory Policy
            csv += `"manual",`; // Variant Fulfillment Service
            csv += `"",`; // Variant Price
            csv += `"",`; // Variant Compare At Price
            csv += `"TRUE",`; // Variant Requires Shipping
            csv += `"TRUE",`; // Variant Taxable
            csv += `"",`; // Variant Barcode
            csv += `"",`; // Image Src
            csv += `"",`; // Image Position
            csv += `"",`; // Image Alt Text
            csv += `"FALSE",`; // Gift Card
            csv += `"",`; // SEO Title
            csv += `"",`; // SEO Description
            csv += `"",`; // Google Shopping / Google Product Category
            csv += `"",`; // Google Shopping / Gender
            csv += `"",`; // Google Shopping / Age Group
            csv += `"",`; // Google Shopping / MPN
            csv += `"",`; // Google Shopping / Condition
            csv += `"",`; // Google Shopping / Custom Product
            csv += `"",`; // Google Shopping / Custom Label 0
            csv += `"",`; // Google Shopping / Custom Label 1
            csv += `"",`; // Google Shopping / Custom Label 2
            csv += `"",`; // Google Shopping / Custom Label 3
            csv += `"",`; // Google Shopping / Custom Label 4
            csv += `"",`; // Variant Image
            csv += `"lb",`; // Variant Weight Unit
            csv += `"",`; // Variant Tax Code
            csv += `"",`; // Cost per item
            csv += `"TRUE",`; // Included / United States
            csv += `"",`; // Price / United States
            csv += `"",`; // Compare At Price / United States
            csv += `"FALSE",`; // Included / International
            csv += `"",`; // Price / International
            csv += `"",`; // Compare At Price / International
            csv += `"active"`; // Status
            csv += '\n';
        });
    });
    
    return csv;
}

function generateNewColorwaysCSV(newColorways) {
    if (newColorways.length === 0) {
        return null;
    }
    
    // Shopify CSV format
    let csv = 'Handle,Title,Body (HTML),Vendor,Product Category,Type,Tags,Published,Option1 Name,Option1 Value,Variant SKU,Variant Grams,Variant Inventory Tracker,Variant Inventory Qty,Variant Inventory Policy,Variant Fulfillment Service,Variant Price,Variant Compare At Price,Variant Requires Shipping,Variant Taxable,Variant Barcode,Image Src,Image Position,Image Alt Text,Gift Card,SEO Title,SEO Description,Google Shopping / Google Product Category,Google Shopping / Gender,Google Shopping / Age Group,Google Shopping / MPN,Google Shopping / Condition,Google Shopping / Custom Product,Google Shopping / Custom Label 0,Google Shopping / Custom Label 1,Google Shopping / Custom Label 2,Google Shopping / Custom Label 3,Google Shopping / Custom Label 4,Variant Image,Variant Weight Unit,Variant Tax Code,Cost per item,Included / United States,Price / United States,Compare At Price / United States,Included / International,Price / International,Compare At Price / International,Status\n';
    
    newColorways.forEach(colorway => {
        colorway.variants.forEach((variant, index) => {
            const isFirstVariant = index === 0;
            
            csv += `"${variant.Handle}",`;
            csv += `"${isFirstVariant ? variant.Title : ''}",`;
            csv += `"",`; // Body (HTML)
            csv += `"",`; // Vendor
            csv += `"",`; // Product Category
            csv += `"",`; // Type
            csv += `"",`; // Tags
            csv += `"TRUE",`; // Published
            csv += `"${isFirstVariant ? 'Size' : ''}",`; // Option1 Name
            csv += `"${variant.Size}",`; // Option1 Value
            csv += `"${variant.SKU}",`; // Variant SKU
            csv += `"0",`; // Variant Grams
            csv += `"shopify",`; // Variant Inventory Tracker
            csv += `"${variant.Quantity}",`; // Variant Inventory Qty - ACTUAL QTY
            csv += `"deny",`; // Variant Inventory Policy
            csv += `"manual",`; // Variant Fulfillment Service
            csv += `"",`; // Variant Price
            csv += `"",`; // Variant Compare At Price
            csv += `"TRUE",`; // Variant Requires Shipping
            csv += `"TRUE",`; // Variant Taxable
            csv += `"",`; // Variant Barcode
            csv += `"",`; // Image Src
            csv += `"",`; // Image Position
            csv += `"",`; // Image Alt Text
            csv += `"FALSE",`; // Gift Card
            csv += `"",`; // SEO Title
            csv += `"",`; // SEO Description
            csv += `"",`; // Google Shopping / Google Product Category
            csv += `"",`; // Google Shopping / Gender
            csv += `"",`; // Google Shopping / Age Group
            csv += `"",`; // Google Shopping / MPN
            csv += `"",`; // Google Shopping / Condition
            csv += `"",`; // Google Shopping / Custom Product
            csv += `"",`; // Google Shopping / Custom Label 0
            csv += `"",`; // Google Shopping / Custom Label 1
            csv += `"",`; // Google Shopping / Custom Label 2
            csv += `"",`; // Google Shopping / Custom Label 3
            csv += `"",`; // Google Shopping / Custom Label 4
            csv += `"",`; // Variant Image
            csv += `"lb",`; // Variant Weight Unit
            csv += `"",`; // Variant Tax Code
            csv += `"",`; // Cost per item
            csv += `"TRUE",`; // Included / United States
            csv += `"",`; // Price / United States
            csv += `"",`; // Compare At Price / United States
            csv += `"FALSE",`; // Included / International
            csv += `"",`; // Price / International
            csv += `"",`; // Compare At Price / International
            csv += `"active"`; // Status
            csv += '\n';
        });
    });
    
    return csv;
}
</script>
</body>
</html>
